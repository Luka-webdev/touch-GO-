const wrapperWelcomeScreen=document.querySelector(".wrapperWelcomeScreen"),wrapperAreaGame=document.querySelector(".wrapperAreaGame"),areaGame=document.querySelector(".areaGame"),closeWelcomeScreen=document.querySelector(".fa-window-close"),continueGame=document.querySelector(".continueGame"),trackWin=document.querySelector(".trackWin"),continueGameBtn=document.querySelector(".fa-arrow-circle-right"),wrapperTracks=document.querySelector(".wrapperTracks"),ball=document.querySelector(".ball"),tracksArray=[track1,track2,track3,track4,track5,track6,track7,track8,track9,track10,track11,track12,track13,track14,track15];let flag=!1,dimensionsAreaGame=getComputedStyle(areaGame),size=.6,actualTrack=0;const settings={shiftX:parseInt(dimensionsAreaGame.marginLeft),shiftY:parseInt(dimensionsAreaGame.marginTop),heightTrackElement:parseInt(dimensionsAreaGame.height)/7,widthTrackElement:parseInt(dimensionsAreaGame.width)/12,ballSize:parseInt(dimensionsAreaGame.height)/7*size},showAreaGame=function(){wrapperAreaGame.classList.remove("visibility"),createTrack()},createTrackBox=function(e){const a=document.createElement("div");a.classList.add("trackBox"),"ready"==e?(a.style.backgroundImage="url(pictures/picture"+actualTrack+".png)",a.addEventListener("click",showAreaGame)):"blocked"==e?a.innerHTML='<i class = "fas fa-lock" ></i>':"done"==e&&(a.style.backgroundImage="url(pictures/picture"+(actualTrack-1)+".png)",a.innerHTML='<i class="fas fa-check"></i>'),wrapperTracks.appendChild(a)},showAllTracks=function(){for(let e=0;e<tracksArray.length;e++)"ready"==tracksArray[e].status?createTrackBox("ready"):"blocked"==tracksArray[e].status?createTrackBox("blocked"):"done"==tracksArray[e].status&&createTrackBox("done")};showAllTracks();const createTrackElement=function(e,a){const t=document.createElement("div");t.classList.add("trackItem"),t.style.gridColumn=e,t.style.gridRow=a,areaGame.appendChild(t)},createTrack=function(){for(let e=0;e<tracksArray[actualTrack].layout.length;e++)createTrackElement(tracksArray[actualTrack].layout[e].column,tracksArray[actualTrack].layout[e].row);createBall()},createBall=function(){ball.style.width=settings.ballSize+"px",ball.style.height=settings.ballSize+"px",ball.style.left="0px",ball.style.top=settings.heightTrackElement*(tracksArray[actualTrack].layout[0].row-1)+settings.heightTrackElement/2-settings.ballSize/2+"px"},gameOver=function(){flag=!1,setTimeout(()=>{continueGame.classList.remove("visibility")},500)},gameOverConditions=function(e){var a=actualColumn*settings.widthTrackElement,t=(actualColumn-1)*settings.widthTrackElement,r=actualRow*settings.heightTrackElement,l=(actualRow-1)*settings.heightTrackElement;switch(e){case"horizontal":(ballCenterY+settings.ballSize/2>r||ballCenterY-settings.ballSize/2<l)&&gameOver();break;case"vertical":(ballCenterX+settings.ballSize/2>a||ballCenterX-settings.ballSize/2<t)&&gameOver();break;case"top-right":(ballCenterX+settings.ballSize/2>a||ballCenterY-settings.ballSize/2<l)&&gameOver();break;case"bottom-left":(ballCenterX-settings.ballSize/2<t||ballCenterY+settings.ballSize/2>r)&&gameOver()}},recognizeTrackElement=function(){ballCenterX=parseInt(ball.style.left)+settings.ballSize/2,ballCenterY=parseInt(ball.style.top)+settings.ballSize/2,actualColumn=Math.ceil(ballCenterX/settings.widthTrackElement),actualRow=Math.ceil(ballCenterY/settings.heightTrackElement);for(let e=0;e<tracksArray[actualTrack].layout.length;e++){var a;tracksArray[actualTrack].layout[e].column==actualColumn&&tracksArray[actualTrack].layout[e].row==actualRow&&(a=tracksArray[actualTrack].layout[e].direction,gameOverConditions(a))}},removeTracksBoxes=function(){var a=wrapperTracks.querySelectorAll("div");for(let e=0;e<a.length;e++)wrapperTracks.removeChild(a[e])},removeTrack=function(){var a=areaGame.querySelectorAll(".trackItem");for(let e=0;e<a.length;e++)areaGame.removeChild(a[e])},trackCrossing=function(){parseInt(ball.style.left)+settings.ballSize>=parseInt(dimensionsAreaGame.width)&&(flag=!1,setTimeout(()=>{trackWin.classList.remove("visibility")},500),setTimeout(()=>{trackWin.classList.add("visibility"),wrapperAreaGame.classList.add("visibility"),tracksArray[actualTrack].status="done",removeTracksBoxes(),removeTrack(),actualTrack++,tracksArray[actualTrack].status="ready",showAllTracks(),createTrack()},3e3))},moveBall=function(e){flag&&(ball.style.top=e.clientY-settings.shiftY-offsetY+"px",ball.style.left=e.clientX-settings.shiftX-offsetX+"px",recognizeTrackElement(),trackCrossing())},getOffsetProperty=function(e){flag=!0,offsetX=e.offsetX,offsetY=e.offsetY};ball.addEventListener("mousedown",getOffsetProperty),ball.addEventListener("mouseup",function(){flag=!1}),areaGame.addEventListener("mousemove",moveBall),closeWelcomeScreen.addEventListener("click",function(){wrapperWelcomeScreen.classList.add("visibility")}),continueGameBtn.addEventListener("click",function(){continueGame.classList.add("visibility"),showAreaGame()});